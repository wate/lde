- name: remove default install index file
  file:
    path: /var/www/html/{{ item }}
    state: absent
  loop:
    - index.html
    - index.nginx-debian.html
  become: true
- name: install php dependency package
  block:
    - name: check exists composer.json
      stat:
        path: /vagrant/src/composer.json
      register: composer_json_result
    - name: check exists composer.lock
      stat:
        path: /vagrant/src/composer.lock
      register: composer_lock_result
    - name: install dependency packages
      composer:
        command: install
        working_dir: /vagrant/src
      when:
        - composer_json_result.stat.exists
        - not composer_lock_result.stat.exists
  become: false
