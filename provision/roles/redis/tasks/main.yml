---
- name: install redis
  ansible.builtin.apt:
    name: redis
- name: create redis setting file
  ansible.builtin.blockinfile:
    path: "{{ redis_config_dir }}/redis.conf"
    block: "{{ redis_extra_cfg  }}"
  notify: restart redis
- name: redis is active and enabled on system startup
  ansible.builtin.systemd:
    name: redis-server
    state: started
    enabled: true
- name: allow fiewwall
  block:
    - name: allow redis port
      ufw:
        port: "{{ redis_port | string }}"
        proto: tcp
        rule: allow
  when: redis_allow_connect_other_host | default(false)
