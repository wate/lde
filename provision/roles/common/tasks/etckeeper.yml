---
- name: install etckeeper
  apt:
    name: etckeeper
- name: check git repository directory
  stat:
    path: /etc/.git
  register: result
- block:
    - name: initilize etckeeper
      command: etckeeper init
      args:
        chdir: /etc
      tags:
        - skip_ansible_lint
    - name: initial commit
      command: etckeeper commit "Initial commit"
      tags:
        - skip_ansible_lint
  when: not result.stat.exists
